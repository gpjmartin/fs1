# Sample Notebooks

1. SEP_Python_pub_v2.ipynb:

Sample Notebook using the trino-python-client, connecting to Starburst Enterprise (>= LTS 429), and running SQL.
Also has a snippet to connect using SQLAlchemy syntax.

2. PyStarburst_pub_v2.ipynb:

Contains PyStarburst syntax (aka Dataframe syntax). Snippets contain examples of using the Dataframe type syntax - which executes as SQL on Starburst. Some sample visuals and Data transforms are included.

**Note: To enable PyStarburst on Starburst Enterprise, please make the following change to config.properties:

starburst.dataframe-api-enabled=true

The above is enabled by default on Galaxy.

**Note: If you are using BIAC or Ranger - you will also need to add a Privilege to the User's Role:

https://docs.starburst.io/latest/client/python.html#enable-pystarburst-in-sep

**Note: The Notebook uses a Table - sample.demo.missions </BR>
This Tables exists by default in Galaxy - but you need to add the sample Catalog to a Cluster.</BR>
If you are using Starburst Enterprise - the catalog/schema/table won't exist by default.</BR>
One option is to sign up to Galaxy, download the file, and upload to an Object Store for Starburst to access.</BR>
Another option is to create the Table manually. See DDL at the bottom of this page to give you a head start.</BR>

For more info on Notebooks and Python: </BR>

https://gpjmartin.wordpress.com/2022/12/06/working-with-starburst-enterprise-and-jupyter-notebooks/</BR>

CREATE TABLE sample.demo.missions (</BR>
   id varchar,</BR>
   company_name varchar,</BR>
   location varchar,</BR>
   date varchar,</BR>
   detail varchar,</BR>
   status_rocket varchar,</BR>
   cost varchar,</BR>
   status_mission varchar</BR>
)</BR>
WITH</BR>
  (</BR>
    FORMAT = 'CSV',</BR>
    EXTERNAL_LOCATION = 's3://PUT_YOUR_ACCOUNT_HERE/mission/',</BR>
    skip_header_line_count = 1,</BR>
  );</BR>

</BR>
If you are unable to download the table/file - sample.demo.missions </BR>
As a workaround, you can use synthetic data from the tpch schema. </BR>
The SQL will load data into the sample.demo.missions table (~60k rows. More rows can be generated by adding in the Tables in the Joins).</BR>
The PyStarburst logic will work functionally - but the data won't mean anything, and the visual won't be informative. </BR>
</BR>
insert into sample.demo.missions2</BR>
(</BR>
SELECT</BR>
  CAST(R.custkey as VARCHAR),</BR>
  R.name, </BR>
  W.name as nation,</BR>
  date_format(cast((Q.shipdate + interval '10' year) as TIMESTAMP with time zone ),'%a %b %d, %Y %H:%i UTC' ),</BR>
  R.mktsegment,</BR>
  P.orderstatus,</BR>
  CAST(R.acctbal as VARCHAR),</BR>
  P.orderpriority</BR>
FROM</BR>
  tpch.tiny.customer AS R</BR>
  INNER JOIN tpch.tiny.orders AS P ON R.CUSTKEY = P.CUSTKEY</BR>
  INNER JOIN tpch.tiny.lineitem AS Q ON P.ORDERKEY = Q.ORDERKEY</BR>
  INNER JOIN tpch.tiny.supplier AS T ON Q.SUPPKEY = T.SUPPKEY</BR>
  --INNER JOIN tpch.tiny.partsupp AS U ON T.SUPPKEY = U.SUPPKEY</BR>
  --INNER JOIN tpch.tiny.part AS V ON U.PARTKEY = V.PARTKEY</BR>
  INNER JOIN tpch.tiny.nation AS W ON T.NATIONKEY = W.NATIONKEY</BR>
  INNER JOIN tpch.tiny.region AS X ON W.REGIONKEY = X.REGIONKEY</BR>
--Add/Remove if required </BR>
--WHERE</BR>
--  X.NAME = 'EUROPE' </BR>
)</BR>
